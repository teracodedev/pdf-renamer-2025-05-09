# =================================================
# PDFリネームツール ルール定義ファイル（サンプル）
# =================================================
#
# このファイルは `rename_rules.yaml` のサンプルです。
# 実際に使用する場合は、このファイルを `rename_rules.yaml` にコピーして
# 必要に応じてカスタマイズしてください。
#
# 各ルールは以下の構造を持ちます：
#
# - ルール:
#     説明: 'ルールの説明（内部管理用）'
#     正規表現: 'OCRテキストとマッチングするパターン'
#     書類の種類: '書類の分類名'
#     命名ルール: '{日付} {取引先}より {内容} ({担当者})' など
#     プロンプト: '|
#       OpenAIに送信するプロンプト。
#       複数行に渡る場合は | を使用'
#     優先順位: 数値（低いほど優先）
#
# 使用可能な変数：
# {日付} - YYYY年MM月DD日 形式
# {今日の日付} - 現在の日付
# {担当者} - 選択された担当者名
# {取引先} - 書類の送信元企業/団体名
# {内容} - 書類の内容の要約
# {金額} - 金額を数字のみで表示
# {申請者} - 申請者の名前
# {年度} - 令和X年度などの年度表記
# {タイトル} - 書類のタイトル
# {組織名} - .envで設定された組織名
# {ocr_result} - OCRで抽出されたテキスト
#
# 注意：
# - 優先順位が低いルールが先に適用されます
# - デフォルトルールは他のどのルールにも当てはまらない場合に使用されます

ファイル命名のルール:
  # ======================================
  # 請求書関連の書類
  # ======================================

  - ルール:
      説明: '一般的な請求書'
      正規表現: '(?i)(請求書|御請求書|ご請求書)'
      書類の種類: '請求書'
      命名ルール: '{日付} {取引先}より {内容}の請求書 金額{金額}円（{担当者}）'
      プロンプト: |
        以下のOCR結果は請求書です。命名ルール「{命名ルール}」に従い、OCR結果から適切な情報を抽出してファイル名を生成してください。
        
        - 日付: OCR結果から請求日または発行日を「YYYY年MM月DD日」形式で抽出してください。
          令和表記や平成表記は西暦に変換してください（令和6年→2024年、平成31年→2019年）。
          日付が不明な場合は現在の日付「{今日の日付}」を使用してください。
        
        - 取引先: OCR結果から請求元の会社名または団体名を抽出してください。
          会社名の前の「株式会社」「有限会社」などは含めてください。
          取引先が不明な場合は「不明」を使用してください。
        
        - 内容: OCR結果から請求内容を簡潔に抽出してください。
          例えば「事務用品」「コピー用紙」「設備点検」などのように具体的な内容を抽出します。
          内容が不明な場合は「商品」を使用してください。
        
        - 金額: OCR結果から請求金額（税込総額）を数字のみで抽出してください。
          例えば「10,800円」から「10800」を抽出します。
          金額が不明な場合は「不明」を使用してください。
        
        - 担当者: 現在の担当者「{担当者}」を使用してください。
        
        結果は、以下のフォーマットに厳密に従ってファイル名を生成してください:
        **{日付} {取引先}より {内容}の請求書 金額{金額}円（{担当者}）**
        
        プレフィックスは付けないでください。
        OCR結果: {ocr_result}
      優先順位: 10

  # ======================================
  # 領収書関連の書類
  # ======================================

  - ルール:
      説明: '一般的な領収書'
      正規表現: '(?i)(領収書|領収証)'
      書類の種類: '領収書'
      命名ルール: '{日付} {取引先}より {内容} 金額{金額}円（{担当者}）'
      プロンプト: |
        以下のOCR結果は領収書です。命名ルール「{命名ルール}」に従い、OCR結果から適切な情報を抽出してファイル名を生成してください。
        
        - 日付: OCR結果から領収日または発行日を「YYYY年MM月DD日」形式で抽出してください。
          令和表記や平成表記は西暦に変換してください（令和6年→2024年、平成31年→2019年）。
          日付が不明な場合は現在の日付「{今日の日付}」を使用してください。
        
        - 取引先: OCR結果から領収書を発行した会社名または店舗名を抽出してください。
          会社名の前の「株式会社」「有限会社」などは含めてください。
          取引先が不明な場合は「不明」を使用してください。
        
        - 内容: OCR結果から購入品目や支払内容を簡潔に抽出してください。
          例えば「事務用品」「会議費」「交通費」などのように具体的な内容を抽出します。
          内容が不明な場合は「支払」を使用してください。
        
        - 金額: OCR結果から領収金額を数字のみで抽出してください。
          例えば「5,500円」から「5500」を抽出します。
          金額が不明な場合は「不明」を使用してください。
        
        - 担当者: 現在の担当者「{担当者}」を使用してください。
        
        結果は、以下のフォーマットに厳密に従ってファイル名を生成してください:
        **{日付} {取引先}より {内容} 金額{金額}円（{担当者}）**
        
        注意事項：
        - 各要素（日付、取引先、内容、金額）の間には必ず半角スペースを入れてください。
        - プレフィックスは付けないでください。
        
        OCR結果: {ocr_result}
      優先順位: 20

  # ======================================
  # 公共料金関連の書類
  # ======================================

  - ルール:
      説明: '電気料金のお知らせ'
      正規表現: '(?i)(電気|電力).*?(ご使用量|料金|請求)'
      書類の種類: '公共料金'
      命名ルール: '{日付} {取引先}より 電気料金のお知らせ 金額{金額}円'
      プロンプト: |
        以下のOCR結果は電気料金のお知らせです。命名ルール「{命名ルール}」に従い、OCR結果から適切な情報を抽出してファイル名を生成してください。
        
        - 日付: OCR結果から検針日や請求日を「YYYY年MM月DD日」形式で抽出してください。
          年月のみの場合は、その月の末日を使用してください（例：2025年3月分→2025年03月31日）。
          日付が不明な場合は現在の日付「{今日の日付}」を使用してください。
        
        - 取引先: OCR結果から電力会社名を抽出してください（例：「中国電力」）。
          取引先が不明な場合は「電力会社」を使用してください。
        
        - 金額: OCR結果から請求金額（税込総額）を数字のみで抽出してください。
          金額が不明な場合は「不明」を使用してください。
        
        結果は、以下のフォーマットに厳密に従ってファイル名を生成してください:
        **{日付} {取引先}より 電気料金のお知らせ 金額{金額}円**
        
        プレフィックスは付けないでください。
        OCR結果: {ocr_result}
      優先順位: 50

  # ======================================
  # デフォルトルール（最後に適用）
  # ======================================

  - デフォルト:
      説明: 'どのルールにも該当しない場合'
      書類の種類: '不明'
      命名ルール: '{日付} {組織名}より {タイトル}（{担当者}）'
      プロンプト: |
        このファイルの種類は「{書類の種類}」です。命名ルール「{命名ルール}」に従い、OCR結果から適切な情報を抽出してファイル名を生成してください。
        
        - 日付は「YYYY年MM月DD日」形式で、OCR結果の中で最も適切と思われる日付を使用してください。
          令和表記や平成表記は西暦に変換してください（令和6年→2024年、平成31年→2019年）。
          日付が不明な場合は現在の日付「{今日の日付}」を使用してください。
        
        - 組織名はOCR結果の中でこの書類を送ってきた組織と思われる名前を使用してください。
          組織名が不明な場合は「不明」を使用してください。
        
        - タイトルはOCR結果の内容を端的に表す短い言葉や、書類に書かれている見出しなどを使用してください。
          タイトルが不明な場合は「書類」を使用してください。
        
        - 担当者: 現在の担当者「{担当者}」を使用してください。
          「担当者自動設定」が指定されている場合は、OCR結果から以下の規則で担当者を自動判断してください:
           - 特定のキーワードがあれば、対応する担当者を設定
           - どのキーワードにも該当しない場合は担当者なし
        
        - 情報が不明な場合は「不明」を使用してください。
        
        結果は、以下のフォーマットに厳密に従ってファイル名を生成してください:
        **{日付} {組織名}より {タイトル}（{担当者}）**
        
        プレフィックスは付けないでください。
        OCR結果: {ocr_result}
      優先順位: 999